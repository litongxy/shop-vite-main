import base from './base.js';
import title from '../rectTitle/index.js';
import { isArray } from '../../../util/type.js';
import merge from '../../../util/merge.js';
import axisOptimization from './axisOptimization.js';

/**
 * Copyright (c) 2024 - present OpenTiny HUICharts Authors.
 * Copyright (c) 2024 - present Huawei Cloud Computing Technologies Co., Ltd.
 *
 * Use of this source code is governed by an MIT-style license.
 *
 * THE OPEN SOURCE SOFTWARE IN THIS PRODUCT IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
 * BUT WITHOUT ANY WARRANTY, WITHOUT EVEN THE IMPLIED WARRANTY OF MERCHANTABILITY OR FITNESS FOR
 * A PARTICULAR PURPOSE. SEE THE APPLICABLE LICENSES FOR MORE DETAILS.
 *
 */

function isNeedTitle(yAxisOpt, yAxisName) {
  if (yAxisName) {
    return true;
  }
  if (yAxisOpt.length === 1 && yAxisOpt[0] && yAxisOpt[0].position !== 'right') {
    return true;
  }
  return false;
}
function yAxis(baseOpt, iChartOpt, chartName, callback) {
  var yAxisOpt = iChartOpt.yAxis;
  var yAxisName = iChartOpt.yAxisName;
  var data = iChartOpt.data;
  if (!isArray(yAxisOpt)) {
    yAxisOpt = [yAxisOpt];
  }
  if (isNeedTitle(yAxisOpt, yAxisName)) {
    var _yAxisOpt$;
    baseOpt.title = title(iChartOpt, chartName, (_yAxisOpt$ = yAxisOpt[0]) == null ? void 0 : _yAxisOpt$.nameTextStyle);
  }
  // 循环y轴配置
  var yAxis = [];
  yAxisOpt.forEach(function (item, index) {
    var temp = base();
    if (item && item.unit) {
      temp.axisLabel.formatter = "{value} " + item.unit;
    }
    if (item && item.formatter) {
      temp.axisLabel.formatter = item.formatter;
    }
    if (item && item.name) {
      item.nameTextStyle = Object.assign(temp.nameTextStyle, item.nameTextStyle);
    }
    if (item && item.labelTextStyle) {
      item.labelTextStyle = Object.assign(temp.axisLabel, item.labelTextStyle);
    }
    if (item && item.splitLine) {
      item.splitLine = Object.assign(temp.splitLine, item.splitLine);
    }
    axisOptimization(item, temp, data);
    callback && callback(temp, index);
    temp = merge(temp, item);
    if (index === 0 && yAxisOpt.length === 1 && temp.position !== 'right') {
      delete temp.name;
    }
    yAxis.push(temp);
  });
  return yAxis;
}
export { yAxis as default };
