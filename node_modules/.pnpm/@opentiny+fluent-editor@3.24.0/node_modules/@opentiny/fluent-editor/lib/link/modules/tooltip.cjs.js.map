{"version":3,"file":"tooltip.cjs.js","sources":["../../../../src/link/modules/tooltip.ts"],"sourcesContent":["import Quill, { Range } from 'quill'\r\nimport Emitter from 'quill/core/emitter'\r\nimport { BaseTooltip } from 'quill/themes/base'\r\nimport { debounce } from '../../../src/utils/debounce'\r\nimport { CHANGE_LANGUAGE_EVENT, LANG_CONF } from '../../config'\r\nimport { hadProtocol, isNullOrUndefined } from '../../config/editor.utils'\r\nimport LinkBlot from '../formats/link'\r\n\r\n// @dynamic\r\nexport default class Tooltip extends BaseTooltip {\r\n  static TEMPLATE: string = [\r\n    `<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"${LANG_CONF['en-US'].linkplaceholder}\" data-video=\"Embed URL\" style=\"width: 225px;\">`,\r\n    '<span class=\"ql-split\"></span>',\r\n    '<a class=\"ql-preview\"><i class=\"icon-share\"></i></a>',\r\n    '<a class=\"ql-remove\"><i class=\"icon-delete\"></i></a>',\r\n  ].join('')\r\n\r\n  isInputFocus: boolean\r\n  isHover: boolean\r\n  debouncedHideToolTip: any\r\n  debouncedShowToolTip: any\r\n  hide: any\r\n  linkRange: any\r\n  quill: any\r\n  root: any\r\n  restoreFocus: any\r\n  textbox: any\r\n  boundsContainer: any\r\n  options: { autoProtocol: string } = {\r\n    autoProtocol: 'https',\r\n  }\r\n\r\n  constructor(quill, bounds) {\r\n    super(quill, bounds)\r\n    this.setTemplate()\r\n    this.isInputFocus = false\r\n    this.isHover = false\r\n\r\n    this.resolveOptions()\r\n    LinkBlot.autoProtocol = this.options.autoProtocol\r\n    this.debouncedHideToolTip = debounce(this.hideToolTip, 300)\r\n    this.debouncedShowToolTip = debounce(this.showToolTip, 300)\r\n    this.quill.on(CHANGE_LANGUAGE_EVENT, () => {\r\n      this.setTemplate()\r\n    })\r\n  }\r\n\r\n  setTemplate() {\r\n    this.root.innerHTML = [\r\n      `<input type=\"text\" data-formula=\"e=mc^2\" data-link=\"${this.quill.options.langText?.linkplaceholder}\" data-video=\"Embed URL\" style=\"width: 225px;\">`,\r\n      '<span class=\"ql-split\"></span>',\r\n      '<a class=\"ql-preview\"><i class=\"icon-share\"></i></a>',\r\n      '<a class=\"ql-remove\"><i class=\"icon-delete\"></i></a>',\r\n    ].join('')\r\n    this.textbox = this.root.querySelector('input[type=\"text\"]')\r\n    this.listen()\r\n  }\r\n\r\n  resolveOptions() {\r\n    this.options = {\r\n      autoProtocol: 'https',\r\n    }\r\n    const value = this.quill.options.autoProtocol\r\n    if (value && typeof value === 'string') {\r\n      this.options.autoProtocol = value\r\n    }\r\n    else if (typeof value === 'boolean' && !value) {\r\n      this.options.autoProtocol = ''\r\n    }\r\n  }\r\n\r\n  shouldHide() {\r\n    return !this.isHover && !this.isInputFocus\r\n  }\r\n\r\n  hideToolTip() {\r\n    if (this.shouldHide()) {\r\n      this.hide()\r\n    }\r\n  }\r\n\r\n  showToolTip(name, value, range) {\r\n    if (!this.shouldHide()) {\r\n      this.edit(name, value, range)\r\n    }\r\n  }\r\n\r\n  handleMouseLeave() {\r\n    this.isHover = false\r\n    this.debouncedHideToolTip()\r\n  }\r\n\r\n  handleMouseEnter(event) {\r\n    const isTooltipShow = !this.root.classList.contains('ql-hidden')\r\n    if (isTooltipShow) {\r\n      return\r\n    }\r\n\r\n    if (this.isInputFocus) {\r\n      this.save()\r\n    }\r\n    this.isHover = true\r\n    const linkNode = event.target\r\n    const preview = LinkBlot.formats(linkNode)\r\n    if (preview.startsWith('#')) {\r\n      return\r\n    }\r\n    const linkBlot = Quill.find(linkNode)\r\n    const index = this.quill.getIndex(linkBlot)\r\n    const [link, offset] = this.quill.scroll.descendant(\r\n      LinkBlot,\r\n      index,\r\n    )\r\n    const length = link && link.length()\r\n    this.linkRange = new Range(index - offset, length)\r\n    this.debouncedShowToolTip('link', preview, this.linkRange)\r\n  }\r\n\r\n  listen() {\r\n    super.listen()\r\n    this.root.querySelector('a.ql-remove').addEventListener('click', (event) => {\r\n      if (!isNullOrUndefined(this.linkRange)) {\r\n        const range = this.linkRange\r\n        this.restoreFocus()\r\n        this.quill.formatText(range, 'link', false, Emitter.sources.API)\r\n        delete this.linkRange\r\n      }\r\n      event.preventDefault()\r\n      this.hide()\r\n    })\r\n\r\n    this.quill.root.addEventListener(\r\n      'mouseover',\r\n      (event) => {\r\n        if (\r\n          (event.target.tagName.toUpperCase() !== 'A'\r\n            || !event.target.classList.contains(LinkBlot.className))\r\n          && !event.target.closest(`a.${LinkBlot.className}`)\r\n        ) {\r\n          return\r\n        }\r\n        this.handleMouseEnter(event)\r\n      },\r\n      false,\r\n    )\r\n\r\n    this.quill.root.addEventListener(\r\n      'mouseout',\r\n      (event) => {\r\n        if (event.target.tagName.toUpperCase() !== 'A' && !event.target.closest(`a.${LinkBlot.className}`)) {\r\n          return\r\n        }\r\n        this.handleMouseLeave()\r\n      },\r\n      false,\r\n    )\r\n\r\n    this.root.addEventListener(\r\n      'mouseenter',\r\n      () => {\r\n        this.isHover = true\r\n      },\r\n      false,\r\n    )\r\n\r\n    this.root.addEventListener('mouseleave', this.handleMouseLeave.bind(this), false)\r\n\r\n    this.root.querySelector('a.ql-preview').addEventListener('click', (event) => {\r\n      const link = LinkBlot.sanitize(this.textbox.value)\r\n      window.open(link, '_blank')\r\n      event.preventDefault()\r\n    })\r\n    this.root.querySelector('input[type=\"text\"]').addEventListener('focus', () => {\r\n      this.isInputFocus = true\r\n    })\r\n    this.root.querySelector('input[type=\"text\"]').addEventListener('blur', () => {\r\n      this.isInputFocus = false\r\n      this.save()\r\n    })\r\n    this.quill.on(\r\n      Emitter.events.SELECTION_CHANGE,\r\n      (range, _oldRange, source) => {\r\n        if (isNullOrUndefined(range)) return\r\n        if (source === Emitter.sources.USER) {\r\n          const [link, offset] = this.quill.scroll.descendant(\r\n            LinkBlot,\r\n            range.index,\r\n          )\r\n\r\n          if (!isNullOrUndefined(link)) {\r\n            this.linkRange = new Range(range.index - offset, link.length())\r\n            const preview = LinkBlot.formats(link.domNode)\r\n            if (!preview.startsWith('#')) {\r\n              this.edit('link', preview, this.linkRange)\r\n            }\r\n            return\r\n          }\r\n        }\r\n        if (this.shouldHide()) {\r\n          this.hide()\r\n        }\r\n      },\r\n    )\r\n    this.quill.on(\r\n      Emitter.events.TEXT_CHANGE,\r\n      () => {\r\n        const selection = this.quill.getSelection()\r\n        const index = selection && selection.index\r\n        setTimeout(() => {\r\n          const link = this.quill.scroll.descendant(\r\n            LinkBlot,\r\n            index,\r\n          )[0]\r\n          if (!link) {\r\n            this.handleMouseLeave()\r\n          }\r\n        })\r\n      },\r\n    )\r\n  }\r\n\r\n  save() {\r\n    let value = this.textbox.value\r\n    if (!value) return\r\n    this.textbox.value = ''\r\n    switch (this.root.getAttribute('data-mode')) {\r\n      case 'link': {\r\n        const { scrollTop } = this.quill.root\r\n        if (this.options.autoProtocol) {\r\n          value = this.addHttpProtocol(value)\r\n        }\r\n\r\n        if (this.linkRange) {\r\n          this.quill.formatText(\r\n            this.linkRange,\r\n            'link',\r\n            value,\r\n            Emitter.sources.USER,\r\n          )\r\n          this.restoreFocus()\r\n        }\r\n        else {\r\n          this.restoreFocus()\r\n          this.quill.format('link', value, Emitter.sources.USER)\r\n        }\r\n        this.quill.root.scrollTop = scrollTop\r\n        break\r\n      }\r\n      case 'formula': {\r\n        const range = this.quill.getSelection(true)\r\n        if (!isNullOrUndefined(range)) {\r\n          const index = range.index + range.length\r\n          this.quill.insertEmbed(\r\n            index,\r\n            this.root.getAttribute('data-mode'),\r\n            value,\r\n            Emitter.sources.USER,\r\n          )\r\n          if (this.root.getAttribute('data-mode') === 'formula') {\r\n            this.quill.insertText(index + 1, ' ', Emitter.sources.USER)\r\n          }\r\n          this.quill.setSelection(index + 2, Emitter.sources.USER)\r\n        }\r\n        break\r\n      }\r\n      case 'video': {\r\n        const range = this.quill.getSelection(true)\r\n        this.quill.insertText(range.index, '\\n', Emitter.sources.USER)\r\n        this.quill.insertEmbed(range.index + 1, 'video', { src: value }, Emitter.sources.USER)\r\n        this.quill.insertText(range.index + 2, '\\n', Emitter.sources.USER)\r\n        this.quill.setSelection(range.index + 3, Emitter.sources.SILENT)\r\n        this.textbox.value = ''\r\n        this.hide()\r\n        break\r\n      }\r\n      default:\r\n    }\r\n  }\r\n\r\n  position(reference) {\r\n    const left = reference.left\r\n    const top = reference.bottom + this.quill.root.scrollTop\r\n    this.root.style.left = `${left}px`\r\n    this.root.style.top = `${top}px`\r\n    this.root.classList.remove('ql-flip')\r\n    const containerBounds = this.boundsContainer.getBoundingClientRect()\r\n    const rootBounds = this.root.getBoundingClientRect()\r\n    let shift = 0\r\n    if (rootBounds.right > containerBounds.right) {\r\n      shift = containerBounds.right - rootBounds.right\r\n      this.root.style.left = `${left + shift}px`\r\n    }\r\n    if (rootBounds.left < containerBounds.left) {\r\n      shift = containerBounds.left - rootBounds.left\r\n      this.root.style.left = `${left + shift}px`\r\n    }\r\n    if (rootBounds.bottom > containerBounds.bottom) {\r\n      const height = rootBounds.bottom - rootBounds.top\r\n      const verticalShift = reference.bottom - reference.top + height\r\n      const fixedTop = top - verticalShift\r\n      this.root.style.top = `${fixedTop < 0 ? this.quill.root.scrollTop + reference.top : fixedTop}px`\r\n      this.root.classList.add('ql-flip')\r\n    }\r\n    return shift\r\n  }\r\n\r\n  // @ts-expect-error\r\n  edit(mode: string = 'link', preview = null, range) {\r\n    this.linkRange = range || this.quill.selection.savedRange\r\n    this.root.classList.remove('ql-hidden')\r\n    this.root.classList.add('ql-editing')\r\n    if (!isNullOrUndefined(preview)) {\r\n      this.textbox.value = preview\r\n    }\r\n    else if (mode !== this.root.getAttribute('data-mode')) {\r\n      this.textbox.value = ''\r\n    }\r\n    this.position(this.quill.getBounds(range || this.quill.selection.savedRange))\r\n    if (this.textbox.value === '') {\r\n      this.textbox.focus()\r\n    }\r\n    this.textbox.setAttribute(\r\n      'placeholder',\r\n      this.textbox.getAttribute(`data-${mode}`) || '',\r\n    )\r\n    this.root.setAttribute('data-mode', mode)\r\n  }\r\n\r\n  show() {\r\n    super.show()\r\n    this.root.removeAttribute('data-mode')\r\n  }\r\n\r\n  addHttpProtocol(url: string) {\r\n    let result = url\r\n    if (!url) {\r\n      return ''\r\n    }\r\n    if (!hadProtocol(url)) {\r\n      result = `${this.options.autoProtocol}://${url}`\r\n    }\r\n    return result\r\n  }\r\n}\r\n"],"names":["BaseTooltip","LinkBlot","debounce","CHANGE_LANGUAGE_EVENT","link","Range","isNullOrUndefined","hadProtocol","LANG_CONF"],"mappings":"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"}