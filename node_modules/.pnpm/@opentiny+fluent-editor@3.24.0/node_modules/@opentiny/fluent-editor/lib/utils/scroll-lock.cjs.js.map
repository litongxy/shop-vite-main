{"version":3,"file":"scroll-lock.cjs.js","sources":["../../../src/utils/scroll-lock.ts"],"sourcesContent":["let scrollBarWidth: number\r\nexport function getScrollBarWidth({ target = document.body } = {}): number {\r\n  if (scrollBarWidth !== undefined) return scrollBarWidth\r\n\r\n  const outer = document.createElement('div')\r\n  outer.className = 'scroll__wrap'\r\n  outer.style.visibility = 'hidden'\r\n  outer.style.width = '100px'\r\n  outer.style.position = 'absolute'\r\n  outer.style.top = '-9999px'\r\n  target.appendChild(outer)\r\n\r\n  const widthNoScroll = outer.offsetWidth\r\n  outer.style.overflow = 'scroll'\r\n\r\n  const inner = document.createElement('div')\r\n  inner.style.width = '100%'\r\n  outer.appendChild(inner)\r\n\r\n  const widthWithScroll = inner.offsetWidth\r\n  outer.parentNode?.removeChild(outer)\r\n  scrollBarWidth = widthNoScroll - widthWithScroll\r\n\r\n  return scrollBarWidth\r\n}\r\n\r\nexport function lockScroll({ target = document.body } = {}) {\r\n  let scrollBarWidth = 0\r\n  let originWidth = '0'\r\n\r\n  const clockClass = 'scroll--lock'\r\n\r\n  const cleanLock = () => {\r\n    target && (target.style.width = originWidth)\r\n    target.classList.remove(clockClass)\r\n  }\r\n\r\n  const hasHiddenClass = target.classList.contains(clockClass)\r\n  if (!hasHiddenClass) {\r\n    originWidth = target.style.width\r\n  }\r\n  scrollBarWidth = getScrollBarWidth({ target })\r\n  const hasOverflow = (target === document.body ? document.documentElement : target).clientHeight < target.scrollHeight\r\n  const overflowY = window.getComputedStyle(target).overflowY\r\n  // only when the scrollbar exists needs to reduce width\r\n  if (scrollBarWidth > 0 && (hasOverflow || overflowY === 'scroll') && !hasHiddenClass) {\r\n    target.style.width = `calc(100% - ${scrollBarWidth}px)`\r\n  }\r\n  target.classList.add(clockClass)\r\n\r\n  return cleanLock\r\n}\r\n"],"names":["scrollBarWidth"],"mappings":";;AAAA,IAAI;AACG,SAAS,kBAAkB,EAAE,SAAS,SAAS,KAAK,IAAI,CAAA,GAAY;;AACrE,MAAA,mBAAmB,OAAkB,QAAA;AAEnC,QAAA,QAAQ,SAAS,cAAc,KAAK;AAC1C,QAAM,YAAY;AAClB,QAAM,MAAM,aAAa;AACzB,QAAM,MAAM,QAAQ;AACpB,QAAM,MAAM,WAAW;AACvB,QAAM,MAAM,MAAM;AAClB,SAAO,YAAY,KAAK;AAExB,QAAM,gBAAgB,MAAM;AAC5B,QAAM,MAAM,WAAW;AAEjB,QAAA,QAAQ,SAAS,cAAc,KAAK;AAC1C,QAAM,MAAM,QAAQ;AACpB,QAAM,YAAY,KAAK;AAEvB,QAAM,kBAAkB,MAAM;AACxB,cAAA,eAAA,mBAAY,YAAY;AAC9B,mBAAiB,gBAAgB;AAE1B,SAAA;AACT;AAEO,SAAS,WAAW,EAAE,SAAS,SAAS,KAAK,IAAI,CAAA,GAAI;AAC1D,MAAIA,kBAAiB;AACrB,MAAI,cAAc;AAElB,QAAM,aAAa;AAEnB,QAAM,YAAY,MAAM;AACX,eAAA,OAAO,MAAM,QAAQ;AACzB,WAAA,UAAU,OAAO,UAAU;AAAA,EAAA;AAGpC,QAAM,iBAAiB,OAAO,UAAU,SAAS,UAAU;AAC3D,MAAI,CAAC,gBAAgB;AACnB,kBAAc,OAAO,MAAM;AAAA,EAC7B;AACAA,oBAAiB,kBAAkB,EAAE,OAAA,CAAQ;AACvC,QAAA,eAAe,WAAW,SAAS,OAAO,SAAS,kBAAkB,QAAQ,eAAe,OAAO;AACzG,QAAM,YAAY,OAAO,iBAAiB,MAAM,EAAE;AAElD,MAAIA,kBAAiB,MAAM,eAAe,cAAc,aAAa,CAAC,gBAAgB;AAC7E,WAAA,MAAM,QAAQ,eAAeA,eAAc;AAAA,EACpD;AACO,SAAA,UAAU,IAAI,UAAU;AAExB,SAAA;AACT;;;"}