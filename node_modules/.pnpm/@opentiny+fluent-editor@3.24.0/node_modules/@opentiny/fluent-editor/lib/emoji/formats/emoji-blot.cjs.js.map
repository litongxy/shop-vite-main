{"version":3,"file":"emoji-blot.cjs.js","sources":["../../../../src/emoji/formats/emoji-blot.ts"],"sourcesContent":["import Quill from 'quill'\r\nimport emojiMap from '../emoji-map'\r\n\r\nconst Embed = Quill.imports['blots/embed']\r\n\r\n// @dynamic\r\nclass EmojiBlot extends Embed {\r\n  static emojiClass: string\r\n  static emojiPrefix: any\r\n  static tagName: string\r\n  static blotName: string\r\n  static className: string\r\n  static create(value) {\r\n    const node = super.create()\r\n    if (typeof value === 'object') {\r\n      EmojiBlot.buildSpan(value, node)\r\n    }\r\n    else if (typeof value === 'string') {\r\n      const valueObj = emojiMap[value]\r\n      if (valueObj) {\r\n        EmojiBlot.buildSpan(valueObj, node)\r\n      }\r\n    }\r\n    // 修复在emoji后输入中文插入其中导致quill不能识别\r\n    node.setAttribute('contenteditable', false)\r\n    return node\r\n  }\r\n\r\n  static value(node) {\r\n    return node.dataset.name\r\n  }\r\n\r\n  static buildSpan(value, node) {\r\n    node.setAttribute('data-name', value.name)\r\n    const emojiSpan = document.createElement('span')\r\n    emojiSpan.classList.add(this.emojiClass)\r\n    emojiSpan.classList.add(this.emojiPrefix + value.name)\r\n    // unicode can be '1f1f5-1f1ea',see emoji-list.js.\r\n    emojiSpan.textContent = String.fromCodePoint(...EmojiBlot.parseUnicode(value.unicode))\r\n    node.appendChild(emojiSpan)\r\n  }\r\n\r\n  static parseUnicode(string) {\r\n    return string.split('-').map(str => Number.parseInt(str, 16))\r\n  }\r\n}\r\n\r\nEmojiBlot.blotName = 'emoji'\r\nEmojiBlot.className = 'ql-emojiblot'\r\nEmojiBlot.tagName = 'span'\r\nEmojiBlot.emojiClass = 'ap'\r\nEmojiBlot.emojiPrefix = 'ap-'\r\n\r\nexport default EmojiBlot\r\n"],"names":["emojiMap"],"mappings":";;;;AAGA,MAAM,QAAQ,MAAM,QAAQ,aAAa;AAGzC,MAAM,kBAAkB,MAAM;AAAA,EAM5B,OAAO,OAAO,OAAO;AACb,UAAA,OAAO,MAAM;AACf,QAAA,OAAO,UAAU,UAAU;AACnB,gBAAA,UAAU,OAAO,IAAI;AAAA,IAAA,WAExB,OAAO,UAAU,UAAU;AAC5B,YAAA,WAAWA,iBAAS,KAAK;AAC/B,UAAI,UAAU;AACF,kBAAA,UAAU,UAAU,IAAI;AAAA,MACpC;AAAA,IACF;AAEK,SAAA,aAAa,mBAAmB,KAAK;AACnC,WAAA;AAAA,EACT;AAAA,EAEA,OAAO,MAAM,MAAM;AACjB,WAAO,KAAK,QAAQ;AAAA,EACtB;AAAA,EAEA,OAAO,UAAU,OAAO,MAAM;AACvB,SAAA,aAAa,aAAa,MAAM,IAAI;AACnC,UAAA,YAAY,SAAS,cAAc,MAAM;AACrC,cAAA,UAAU,IAAI,KAAK,UAAU;AACvC,cAAU,UAAU,IAAI,KAAK,cAAc,MAAM,IAAI;AAE3C,cAAA,cAAc,OAAO,cAAc,GAAG,UAAU,aAAa,MAAM,OAAO,CAAC;AACrF,SAAK,YAAY,SAAS;AAAA,EAC5B;AAAA,EAEA,OAAO,aAAa,QAAQ;AACnB,WAAA,OAAO,MAAM,GAAG,EAAE,IAAI,SAAO,OAAO,SAAS,KAAK,EAAE,CAAC;AAAA,EAC9D;AACF;AAEA,UAAU,WAAW;AACrB,UAAU,YAAY;AACtB,UAAU,UAAU;AACpB,UAAU,aAAa;AACvB,UAAU,cAAc;;"}